## Example 11

yarn global add pageres-cli

pageres https://xstate.js.org/viz/ 1366x768 --selector='div[data-type*=machine] > div[data-type*=machine]' --filename='screenshot-<%= date %>' --overwrite

XState server-side: https://github.com/davidkpiano/xstate/issues/638

## Export state machine

https://github.com/statecharts/xstate-viz

## Setup

Run `yarn bootstrap && yarn start`

## Bootstrapping the App

Running `DEBUG=* yarn bootstrap` will do the following:

- Install packages
- Create the example DB
- Seed the database with test data

## Running the App

To run the project, run `yarn start`. This will:

- Run the API server
- Open GraphQL Playground


    var el = document.querySelector(".ace_text-input");
    el.value = `

const fetchMachine = Machine({
id: 'fetch',
initial: 'idle',
context: {
retries: 0
},
states: {
idle: {
on: {
FETCH: 'loading'
}
},
loading: {
on: {
RESOLVE: 'success',
REJECT: 'failure'
}
},
success: {
type: 'final'
},
failure: {
on: {
RETRY: {
target: 'loading',
actions: assign({
retries: (context, event) => context.retries + 1
})
}
}
}
}
});

`;
var evt= new Event('change');
el.dispatchEvent(evt);

document.querySelector('button[data-variant="secondary"]').click()

function click(x,y){
var ev = document.createEvent("MouseEvent");
var el = document.elementFromPoint(x,y);
console.log(el)
ev.initMouseEvent(
"click",
true /_ bubble _/, true /_ cancelable _/,
window, null,
x, y, 0, 0, /_ coordinates _/
false, false, false, false, /_ modifier keys _/
0 /_left_/, null
);
el.dispatchEvent(ev);
}

## Printing

## Steps

- Load State Chart class
- Turn to json
- Upload to GitHub (public)
- https://xstate.js.org/viz/?gist=f12af6ada90870c1144e9266e59742d5
- Delete state chart

## Post Gist to github

Request URL: https://api.github.com/gists
Request Method: POST
Status Code: 201 Created
Remote Address: 140.82.113.6:443
Referrer Policy: no-referrer-when-downgrade
Access-Control-Allow-Origin: _
Access-Control-Expose-Headers: ETag, Link, Location, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes, X-Poll-Interval, X-GitHub-Media-Type
Cache-Control: private, max-age=60, s-maxage=60
Content-Length: 4149
Content-Security-Policy: default-src 'none'
Content-Type: application/json; charset=utf-8
Date: Tue, 17 Dec 2019 00:08:34 GMT
ETag: "d536380e02651097fac749f1afb8059e"
Location: https://api.github.com/gists/f12af6ada90870c1144e9266e59742d5
Referrer-Policy: origin-when-cross-origin, strict-origin-when-cross-origin
Server: GitHub.com
Status: 201 Created
Strict-Transport-Security: max-age=31536000; includeSubdomains; preload
Vary: Accept, Authorization, Cookie, X-GitHub-OTP
X-Accepted-OAuth-Scopes:
X-Content-Type-Options: nosniff
X-Frame-Options: deny
X-GitHub-Media-Type: github.v3; format=json
X-GitHub-Request-Id: EFAB:4538:D37B:1E516:5DF81C80
X-OAuth-Client-Id: 39c1ec91c4ed507f6e4c
X-OAuth-Scopes: gist
X-RateLimit-Limit: 5000
X-RateLimit-Remaining: 4998
X-RateLimit-Reset: 1576544901
X-XSS-Protection: 1; mode=block
Accept: _/\*
Accept-Encoding: gzip, deflate, br
Accept-Language: en-US,en;q=0.9
Authorization: token 8160216b4c96f935862ccb733fa66c435700831d
Connection: keep-alive
Content-Length: 394
Content-Type: text/plain;charset=UTF-8
Host: api.github.com
Origin: https://xstate.js.org
Referer: https://xstate.js.org/viz/
Sec-Fetch-Mode: cors
Sec-Fetch-Site: cross-site
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.79 Safari/537.36
{description: "Generated by XState Viz: https://xstate.js.org/viz", public: true,…}
description: "Generated by XState Viz: https://xstate.js.org/viz"
public: true
files: {machine.js: {,…}}
machine.js: {,…}
content: "↵ const fetchMachine = Machine({↵ id: 'fetch',↵ initial: 'idle',↵ context: {↵ retries: 0↵ },↵ states: {↵ idle: {↵ on: {↵ FETCH: 'success'↵ }↵ },↵ success: {↵ type: 'final'↵ }↵ }↵ }); "
